labs(
title = plot_title_state,
subtitle = plot_subtitle_state,
caption = plot_caption_state
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_state_map)
# ggsave("venezuela_state_gdp_continuous_map.png", plot = venezuela_state_map, width = 8, height = 10, dpi = 300)
# --- Plot 2: Municipality Level Map ---
plot_title_municipality <- "PIB per cápita de Venezuela (2021) ponderado por municipio"
plot_subtitle_municipality <- "Precios corrientes (USD)"
plot_caption_municipality <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nDatos: Rossi-Hansberg & Zhang (2025)"
venezuela_municipality_map <- ggplot() +
geom_sf(
data = municipality_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.2
) +
geom_sf(
data = country_sf,
fill = NA,
color = "black",
linewidth = 1
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_municipality,
subtitle = plot_subtitle_municipality,
caption = plot_caption_municipality
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_municipality_map)
venezuela_state_map <- ggplot() +
geom_sf(
data = state_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.5
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_state,
subtitle = plot_subtitle_state,
caption = plot_caption_state
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_state_map)
ggsave(
filename = "mapa_VE_PIBpc_estados.png",
plot = venezuela_state_map,
width = 8,
height = 6,
dpi = 400,    # 400 a 600 ppp es excelente para PNG de alta calidad
device = "png" # Especifica el formato de salida
)
ggsave(
filename = "mapa_VE_PIBpc_estados.png",
plot = venezuela_state_map,
width = 4,
height = 3,
dpi = 400,    # 400 a 600 ppp es excelente para PNG de alta calidad
device = "png" # Especifica el formato de salida
)
plot_title_municipality <- "PIB per cápita de Venezuela (2021) ponderado por municipio"
plot_subtitle_municipality <- "Precios corrientes (USD)"
plot_caption_municipality <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nDatos: Rossi-Hansberg & Zhang (2025)"
venezuela_municipality_map <- ggplot() +
geom_sf(
data = municipality_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.2
) +
geom_sf(
data = country_sf,
fill = NA,
color = "black",
linewidth = 1
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_municipality,
subtitle = plot_subtitle_municipality,
caption = plot_caption_municipality
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_municipality_map)
venezuela_municipality_map <- ggplot() +
geom_sf(
data = municipality_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.2
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_municipality,
subtitle = plot_subtitle_municipality,
caption = plot_caption_municipality
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_municipality_map)
#### 6. Plot the map ####
# Plot title and subtitle
plot_title <- "PIB per cápita de Venezuela (2021) cada 0.25°x 0.25°"
plot_subtitle <- "Precios corrientes (USD)"
plot_caption <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nDatos: Rossi-Hansberg & Zhang (2025)"
# Define the border color for the squares
grid_border_color <- "grey70"
# Create the map
venezuela_map <- ggplot() +
# 1. Add the main grid data layer (Venezuela)
geom_sf(
data = bfi_merged_sf,
aes(fill = gdp_decile),
# FIX: Change color from NA to a light gray
color = grid_border_color,
size = 0.075 # This controls the thickness of the border line
) +
# 2. Add the Esequibo grid data layer (Guyana data for Esequibo)
geom_sf(
data = bfi_esequibo_sf,
aes(fill = gdp_decile),
# FIX: Change color from NA to a light gray
color = grid_border_color,
size = 0.075
) +
# 3. Add state borders (Venezuela only)
geom_sf(
data = state_sf,
fill = NA,
color = "grey30",
linewidth = 0.5
) +
# 4. Add the Esequibo claimed border (distinct visual style)
geom_sf(
data = esequibo_sf,
fill = NA,
color = "red",
linetype = "dashed",
linewidth = 1
) +
# 5. Add country border for the outline
geom_sf(
data = country_sf,
fill = NA,
color = "black",
linewidth = 1
) +
# 6. Apply the custom color palette
scale_fill_manual(
values = rev(gdp_colors),
name = "PIB per cápita (USD)",
drop = FALSE
) +
# 7. Add labs and theme
labs(
title = plot_title,
subtitle = plot_subtitle,
caption = plot_caption
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
# Display the map
print(venezuela_map)
plot_title_EN <- "Venezuela GDP per Capita (2021) by 0.25°x 0.25° cells"
plot_subtitle_EN <- "Current Prices (USD)"
plot_caption_EN <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
plot_title_EN <- "Venezuela GDP per Capita (2021) by 0.25°x 0.25° cells"
plot_subtitle_EN <- "Current Prices (USD)"
plot_caption_EN <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
# Define the border color for the squares
grid_border_color <- "grey70"
# Create the map
venezuela_map <- ggplot() +
# 1. Add the main grid data layer (Venezuela)
geom_sf(
data = bfi_merged_sf,
aes(fill = gdp_decile),
# FIX: Change color from NA to a light gray
color = grid_border_color,
size = 0.075 # This controls the thickness of the border line
) +
# 2. Add the Esequibo grid data layer (Guyana data for Esequibo)
geom_sf(
data = bfi_esequibo_sf,
aes(fill = gdp_decile),
# FIX: Change color from NA to a light gray
color = grid_border_color,
size = 0.075
) +
# 3. Add state borders (Venezuela only)
geom_sf(
data = state_sf,
fill = NA,
color = "grey30",
linewidth = 0.5
) +
# 4. Add the Esequibo claimed border (distinct visual style)
geom_sf(
data = esequibo_sf,
fill = NA,
color = "red",
linetype = "dashed",
linewidth = 1
) +
# 5. Add country border for the outline
geom_sf(
data = country_sf,
fill = NA,
color = "black",
linewidth = 1
) +
# 6. Apply the custom color palette
scale_fill_manual(
values = rev(gdp_colors),
name = "GDP per capita (USD)",
drop = FALSE
) +
# 7. Add labs and theme
labs(
title = plot_title_EN,
subtitle = plot_subtitle_EN,
caption = plot_caption_EN
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "right",
legend.title = element_text(face = "bold"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
# Display the map
print(venezuela_map)
plot_title_state_EN <- "Venezuela GDP per capita (2021) by state"
plot_subtitle_state_EN <- "Current Prices (USD)"
plot_caption_state_EN <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
venezuela_state_map <- ggplot() +
geom_sf(
data = state_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.5
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_state_EN,
subtitle = plot_subtitle_state_EN,
caption = plot_caption_state_EN
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_state_map)
grid_border_color <- "white"
plot_title_state_EN <- "Venezuela GDP per capita (2021) by state"
plot_subtitle_state_EN <- "Current Prices (USD)"
plot_caption_state_EN <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
venezuela_state_map <- ggplot() +
geom_sf(
data = state_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.5
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_state_EN,
subtitle = plot_subtitle_state_EN,
caption = plot_caption_state_EN
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_state_map)
plot_title_municipality <- "Venezuela GDP per capita (2021) by municipality"
plot_subtitle_municipality <- "Current Prices (USD)"
plot_caption_municipality <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
venezuela_municipality_map <- ggplot() +
geom_sf(
data = municipality_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.2
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_municipality_EN,
subtitle = plot_subtitle_municipality_EN,
caption = plot_caption_municipality_EN
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
plot_title_municipality <- "Venezuela GDP per capita (2021) by municipality"
plot_subtitle_municipality <- "Current Prices (USD)"
plot_caption_municipality <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
venezuela_municipality_map <- ggplot() +
geom_sf(
data = municipality_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.2
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_municipality_EN,
subtitle = plot_subtitle_municipality_EN,
caption = plot_caption_municipality_EN
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
plot_title_municipality_EN <- "Venezuela GDP per capita (2021) by municipality"
plot_subtitle_municipality_EN <- "Current Prices (USD)"
plot_caption_municipality_EN <- "©2025 Pablo Hernández Borges | pablohernandezb.dev\nData: Rossi-Hansberg & Zhang (2025)"
venezuela_municipality_map <- ggplot() +
geom_sf(
data = municipality_sf_aggregated,
# FIX: Map the continuous variable 'aggregated_gdp' to fill
aes(fill = aggregated_gdp),
color = grid_border_color,
linewidth = 0.2
) +
scale_fill_viridis_c(
option = "A", # Option "A" is Magma. Option "D" is Viridis.
direction = -1, # Use 1 to map low values to light colors, high values to dark colors (as is standard for GDP/income)
name = color_name
#labels = scales::label_number(big.mark = ",", decimal.mark = ".", scale = 1e-9, suffix = "B")
) +
labs(
title = plot_title_municipality_EN,
subtitle = plot_subtitle_municipality_EN,
caption = plot_caption_municipality_EN
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10, hjust = 0),
legend.position = "bottom",
legend.title = element_text(face = "bold", size = 10),
legend.text = element_text(size = 9),
legend.key.width = unit(1.5, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
)
print(venezuela_municipality_map)
# ggsave("venezuela_municipality_gdp_continuous_map.png", plot = venezuela_municipality_map, width = 8, height = 10, dpi = 300)
